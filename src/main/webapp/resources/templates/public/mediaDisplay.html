<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Diswork</title>
    <style>
        #addButton {
            display: block;
        }
        #authorizedUserSection{
            display: none;
        }
    </style>
    <link href="/resources/css/toastr.css" rel="stylesheet"/>
</head>
<body>

<section>
<h1  th:text="${ media.getMediaName() != null ? media.getMediaName() : 'Название не указано'}"></h1>
<img  th:src="${media.getPosterPath()}" width="230px" height="320px" alt="Постер">
<p  th:text="'Тип: ' + ${ media.getType() != null ? media.getType().getTypeName() : ' Тип не указан'}"></p>
    <p  th:text="'Год выхода: ' + ${ media.getYearOfRelease() != null ? media.getYearOfRelease() : ' Год релиза не указан'}"></p>
<p  th:text="'Количество эпизодов: ' + ${media.getEpisodeCount() != null ? media.getEpisodeCount() : ' Кол-во  эпизодов не указано'}"></p>
<p  th:text="'Длительность эпизода: ' + ${media.getDuration() != null ? media.getDuration() + ' минут' : 'Длительность не указана'}"></p>
<p  th:text="'Статус: ' + ${media.getStatus() != null ? media.getStatus().getStatusName() : 'Статус не указан'}"></p>
<p>Тэги:</p>
<tr th:each="tag: ${media.getTags()}">
    <span th:text="${tag.getTagName()}"></span>
</tr>
<p  th:text="'Возрастной рейтинг: ' + ${media.getAgeRating() != null ? media.getAgeRating() : 'Возрастной рейтинг не указан'}"></p>
<p  th:text="'ОПИСАНИЕ: ' + ${media.getDescription() != null ? media.getDescription() : 'описание не указано' }"></p>
    <p th:text = "'Рейтинг: ' + ${avgRating}"></p>
</section>
<section>
<td><button id="addButton" th:one="${media.getId()}" th:two="${_csrf.token}" onclick="fetchAndAddMedia(this.getAttribute('one'), this.getAttribute('two'))">Добавить произведение в избранное</button></td>
    <div id= "authorizedUserSection">
<td><button id="deleteButton" th:one="${media.getId()}" th:two="${_csrf.token}" onclick="fetchAndDeleteMedia(this.getAttribute('one'), this.getAttribute('two'))">Удалить из избранного</button></td>
    <label id ="valueSelectLabel" for="valueSelect">Оцените произведение:</label>
    <select id="valueSelect" name="selectedValue" th:value="*{grading.getGrade()}">
        <option id="valueOption" th:each="value : ${#numbers.sequence(1, 10)}" th:value="${value}" th:text="${value}"></option>
    </select>
    <td><button id="gradingButton" th:one="${media.getId()}" th:two="${_csrf.token}" onclick="fetchAndAssessmentMedia(this.getAttribute('one'), this.getAttribute('two'))">Оценить</button></td>
    <div id="gradeTextArea" ></div>
    </div>
</section>
<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
<input type="hidden" id="isAddButtonHidden"  th:value="${isAddButtonHidden}">
<input type="hidden" id="grade"  th:value="${grade}">


<script src="/resources/js/mediaDisplay.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="/resources/js/toastr.min.js"></script>
</body>
</html>